setwd("~/R_2.Hafta")
library(tidyverse) #tidyverse is a package group which includes dplyr as well
library(lubridate)
raw_df <- readRDS("rp_201801_202005_df.rds")
print(raw_df)
raw_df %>% filter(wind_lic + wind_ul < sun_lic + sun_ul)
raw_df %>%
group_by(dt::year) %>%
summarise(mean_geo  = mean(med_geothermal_lic ), sd_geo = sd(med_geothermal_lic ))
raw_df %>%
group_by(lubridate::year) %>%
summarise(mean_geo  = mean(med_geothermal_lic ), sd_geo = sd(med_geothermal_lic ))
library(lubridate)
year(mdy(dt))
library(lubridate)
year(mdy(dt))
library(lubridate)
raw_df %>%
group_by(lubridate::year(dt)) %>%
summarise(mean_geo  = mean(med_geothermal_lic ), sd_geo = sd(med_geothermal_lic ))
rlang::last_error()
names(raw_df)
raw_df %>%
group_by(lubridate::year(dt)) %>%
summarise(mean_geo  = mean(geothermal_lic ), sd_geo = sd(geothermal_lic ))
raw_df %>%
filter(lubridate::month(dt)=5 & lubridate::year(dt)=2020)
raw_df %>%
filter(lubridate::month(dt)==5 & lubridate::year(dt)==2020)
raw_df %>%
filter(lubridate::month(dt)==5 & lubridate::year(dt)==2020) %>%
group_by(lubridate::month(hour)) %>%
summarise(avg_prod  = mean(sun_ul))
raw_df %>%
filter(lubridate::month(dt)==5 & lubridate::year(dt)==2020) %>%
group_by(lubridate::hour(dt)) %>%
summarise(avg_prod  = mean(sun_ul))
raw_df %>%
select(biomass_lic, ubridate::as_date(dt))
raw_df %>%
select(biomass_lic, lubridate::as_date(dt))
raw_df %>%
select(biomass_lic, dt)
raw_df %>%
select(biomass_lic, lubridate::as_date(dt))
raw_df %>%
select(biomass_lic, as_date(dt))
raw_df %>%
select(biomass_lic, as_Date(dt))
raw_df %>%
select(biomass_lic, as.Date(dt))
raw_df %>%
select(biomass_lic, as_date(data$column))
raw_df %>%
select(biomass_lic, as_date(dt))
raw_df %>%
select(biomass_lic, as_date(dt, format = '%m-%d-%Y'))
raw_df %>%
select(biomass_lic, as_date(dt, format = "%m-%d-%Y"))
raw_df %>%
select(biomass_lic, as_date(dt, lubridate::dmy(dt)))
raw_df %>%
select(biomass_lic, as_date(dt / (1000 * 60 * 60 * 24)))
raw_df %>%
select(biomass_lic, dt)
raw_df %>%
select(biomass_lic,  as.Date(dt)))
raw_df %>%
select(biomass_lic,  as.Date(dt))
raw_df %>%
select(biomass_lic,  lubridate::as.Date(dt))
raw_df %>%
select(biomass_lic,  as_date(dt, origin = lubridate::origin))
raw_df %>%
select(biomass_lic,  as_date(dt))
rlang::last_error()
raw_df %>%
select(biomass_lic,  mdy(dt))
raw_df %>%
select(biomass_lic,  lubridate::mdy(dt))
library(lubridate, warn.conflicts = FALSE)
raw_df %>%
select(biomass_lic,  lubridate::mdy(dt))
raw_df %>%
select(biomass_lic,  lubridate::year(dt))
raw_df %>%
select(lubridate::year(dt))
raw_df %>%
group_by(lubridate::dmy(dt)) %>%
summarise()
raw_df %>%
group_by(lubridate::year(dt)) %>%
summarise()
raw_df %>%
group_by(lubridate::mdy(dt)) %>%
summarise()
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise()
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise(mean(biomass_lic))
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise(mean(biomass_lic),lag(),lead())
raw_df %>%
transmute(dt, wind_lic, wind_lic_prev_h = lead(wind_lic,1), wind_lic_next_h = lag(wind_lic,1))
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic))) %%
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %%
transmute(lubridate::as_date(dt), avg_bio, avg_bio_prev_h = lead(avg_bio,1), wind_lic_next_h = lag(avg_bio,1))
raw_df %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(lubridate::as_date(dt), avg_bio, avg_bio_prev_h = lead(avg_bio,1), wind_lic_next_h = lag(avg_bio,1))
raw_df %>%
group_by(dt_date = lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(dt_date, avg_bio, avg_bio_prev_h = lead(avg_bio,1), wind_lic_next_h = lag(avg_bio,1))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1))
raw_df %>%
filter(lubridate::month(dt)==5 & lubridate::year(dt)==2020) %>%
group_by(lubridate::hour(dt)) %>%
summarise(avg_prod  = mean(sun_ul))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
select((bio_next_h-bio_prev_h)/bio_prev_h))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
select((bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
summirise((bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
filter((bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
select(bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
select(bio_next_h-bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
select(3-5)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(3-5)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate((bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
select(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
transmute(lubridate::as_date(dt), biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date = lubridate::as_date(dt), biomass_lic = mean(biomass_lic))
transmute(date, biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date = lubridate::as_date(dt), biomass_lic = mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise( biomass_lic = mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date_ =  biomass_lic_ = mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date_ = lubridate::as_date(dt)), biomass_lic_ = mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date_ = lubridate::as_date(dt), biomass_lic_ = mean(biomass_lic))
transmute(date_, biomass_lic_, bio_prev_h = lead(biomass_lic_,1), bio_next_h = lag(biomass_lic_,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(date_ = lubridate::as_date(dt), biomass_lic_ = mean(biomass_lic))
transmute(date_, biomass_lic_, bio_prev_h = lead(biomass_lic_,1), bio_next_h = lag(biomass_lic_,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(lubridate::as_date(dt), biomass_lic_ = mean(biomass_lic))
transmute(biomass_lic_, bio_prev_h = lead(biomass_lic_,1), bio_next_h = lag(biomass_lic_,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(lubridate::as_date(dt), biomass_lic = mean(biomass_lic))
transmute(biomass_lic, bio_prev_h = lead(biomass_lic,1), bio_next_h = lag(biomass_lic,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(lubridate::as_date(dt), biomass_lic = mean(biomass_lic))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt), mean(biomass_lic)) %>%
summarise(lubridate::as_date(dt), biomass_lic = mean(biomass_lic))
raw_df %>%
arrange(dt,biomass_lic) %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(lubridate::as_date(dt),mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(lubridate::as_date(dt),mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
filter(daily_diff!=NA) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
filter(daily_diff!=NaN) %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lead(avg_bio,1), bio_next_h = lag(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h) %>%
filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
summarise(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
mutate(mean(daily_diff))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
summarise(mean(c(daily_diff)))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
summarise(mean(c(daily_diff)))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
ummarize(Mean. = mean(c(daily_diff)))
raw_df %>%
filter(lubridate::year(dt)==2019) %>%
arrange(dt) %>%
group_by(lubridate::as_date(dt)) %>%
summarise(avg_bio = mean(biomass_lic)) %>%
transmute(avg_bio, bio_prev_h = lag(avg_bio,1), bio_next_h = lead(avg_bio,1)) %>%
mutate(daily_diff = (bio_next_h-bio_prev_h)/bio_prev_h)-1 %>%
#filter(daily_diff!='NA') %>%
summarize(Mean. = mean(c(daily_diff)))
